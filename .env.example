# ===========================================
# NexusNote 环境配置模板 (2026 Modern Stack)
# ===========================================
# 复制此文件为 .env 并填入你的配置

# ===========================================
# 数据库（必需）
# ===========================================
DATABASE_URL=postgresql://user:password@host:5432/nexusnote

# ===========================================
# Redis（可选，用于队列和缓存）
# ===========================================
REDIS_URL=redis://localhost:6379

# ===========================================
# AI Provider（必需 - 至少配置一个）
# ===========================================

# 302.ai API Key（推荐 - 支持所有模型）
AI_302_API_KEY=sk-your-302ai-api-key

# DeepSeek API Key（备选）
DEEPSEEK_API_KEY=sk-your-deepseek-api-key

# OpenAI API Key（备选）
OPENAI_API_KEY=sk-your-openai-api-key

# ===========================================
# AI 可观测性（可选 - 推荐用于生产环境）
# ===========================================

# Langfuse API Keys（AI SDK v6 官方推荐）
# 功能：自动追踪 tokens、成本、延迟、工具调用
# 注册地址：https://langfuse.com/signup（免费）
LANGFUSE_PUBLIC_KEY=pk-lf-your-public-key
LANGFUSE_SECRET_KEY=sk-lf-your-secret-key

# ===========================================
# AI 模型配置（可选 - 有默认值）
# ===========================================

# 通用模型 - Gemini 3 Flash（对话、快速生成、Agent）
AI_MODEL=gemini-3-flash-preview

# Pro 模型 - Gemini 3 Pro（课程内容、长文本）
AI_MODEL_PRO=gemini-3-pro-preview

# 联网搜索模型 - Gemini 3 Flash + Web Search（课程大纲）
AI_MODEL_WEB_SEARCH=gemini-3-flash-preview-web-search

# ===========================================
# Embedding 配置
# ===========================================

# Embedding 模型
EMBEDDING_MODEL=Qwen/Qwen3-Embedding-8B

# Embedding 维度（需与 pgvector halfvec 配置一致）
EMBEDDING_DIMENSIONS=4000

# ===========================================
# Reranker 配置（可选）
# ===========================================
RERANKER_MODEL=Qwen/Qwen3-Reranker-8B
RERANKER_ENABLED=false

# ===========================================
# RAG 高级优化（2026 功能 - 可选）
# ===========================================

# Query Rewriting - 用 LLM 优化用户查询以提高检索质量
# 示例："它怎么收费" → "NexusNote 的定价策略和收费方式"
QUERY_REWRITING_ENABLED=false

# Hybrid Search - 结合向量检索和 BM25 关键词检索
# 适用于专业术语多、关键词匹配重要的场景
HYBRID_SEARCH_ENABLED=false

# Context Compression - 压缩检索结果，只保留最相关片段
# 减少 LLM 输入 tokens，降低成本和延迟
CONTEXT_COMPRESSION_ENABLED=false

# Fast Model - 用于 Query Rewriting 等轻量任务
AI_FAST_MODEL=gemini-3-flash-preview

# ===========================================
# Notes / Liquid Knowledge 配置
# ===========================================

# 语义聚类阈值（0-1，越小越严格）
NOTES_TOPIC_THRESHOLD=0.25

# ===========================================
# 认证（必需）
# ===========================================
# NextAuth 5.x 必需的加密密钥（生产环境用 openssl rand -base64 32）
AUTH_SECRET=your-random-32-char-auth-secret

# JWT 签名密钥（与后端 NestJS 共享）
JWT_SECRET=your-random-32-char-secret-key

# ===========================================
# 服务地址
# ===========================================

# 开发环境
NEXT_PUBLIC_API_URL=http://localhost:3001
NEXT_PUBLIC_COLLAB_URL=ws://localhost:1234

# 生产环境（部署时修改）
# NEXT_PUBLIC_API_URL=https://your-api.onrender.com
# NEXT_PUBLIC_COLLAB_URL=wss://your-api.onrender.com
